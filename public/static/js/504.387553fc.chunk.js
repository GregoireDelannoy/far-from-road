!function(){"use strict";var n={1504:function(n,t,e){var o,i=e(4165),a=e(5861),r=e(9466),s=e(5671),u=e(3076),c=e(597),d=e(4721),f=e(940);function l(n,t,e,i,a){var r=function(n){switch(n){case o.BLACK:return[0,0,0];case o.BLUE:return[0,0,255];case o.RED:return[255,0,0];default:return[0,0,0]}}(a),s=i*t+e<<2;n[s]=r[0],n[s+1]=r[1],n[s+2]=r[2],n[s+3]=196}function x(n){for(var t=new f.PNG({colorType:0,width:n.dimensions.x,height:n.dimensions.y,filterType:-1}),e=0;e<n.dimensions.x;e++)for(var i=0;i<n.dimensions.y;i++)n.data[e][i].hasRoad>0?l(t.data,n.dimensions.x,e,i,o.BLACK):n.data[e][i].isLand?n.data[e][i].withinBounds||l(t.data,n.dimensions.x,e,i,o.RED):l(t.data,n.dimensions.x,e,i,o.BLUE);return f.PNG.sync.write(t)}!function(n){n[n.BLACK=0]="BLACK",n[n.BLUE=1]="BLUE",n[n.RED=2]="RED"}(o||(o={}));var h=(0,r.Z)((function n(){(0,s.Z)(this,n),this.hasRoad=0,this.isLand=!0,this.withinBounds=!1,this.excluded=!1})),m=(0,r.Z)((function n(){(0,s.Z)(this,n),this.dimensions={x:0,y:0,increment:0},this.data=[],this.furthestAway=null,this.bbox={latMin:0,latMax:0,longMin:0,longMax:0},this.countExcludedElements=0}));function b(n,t){return t.lat<n.bbox.latMin||t.lat>n.bbox.latMax||t.long<n.bbox.longMin||t.long>n.bbox.longMax?null:{x:Math.min(Math.floor((t.long-n.bbox.longMin)/n.dimensions.increment),n.dimensions.x-1),y:Math.min(n.dimensions.y-Math.floor((t.lat-n.bbox.latMin)/n.dimensions.increment),n.dimensions.y-1)}}function y(n,t){return[n.bbox.longMin+(t.x+.5)*n.dimensions.increment,n.bbox.latMin+(.5+n.dimensions.y-t.y)*n.dimensions.increment]}function p(n,t,e,o){t<0||t>=n.dimensions.x||e<0||e>=n.dimensions.y||0===n.data[t][e].hasRoad&&(n.data[t][e].hasRoad=o+1,n.data[t][e].isLand&&n.data[t][e].withinBounds&&(n.countExcludedElements++,n.furthestAway||n.countExcludedElements!==n.dimensions.x*n.dimensions.y||(n.furthestAway={x:t,y:e})))}function w(n,t){for(var e=0;e<n.dimensions.x;e++)for(var o=0;o<n.dimensions.y;o++)n.data[e][o].hasRoad===t&&(p(n,e-1,o,t),p(n,e+1,o,t),p(n,e,o-1,t),p(n,e,o+1,t));return n}function v(n,t){return n[0]>t[0]&&n[0]<t[2]&&n[1]>t[1]&&n[1]<t[3]}function g(n,t,e){var o=new m;o.bbox=n,o.dimensions=function(n){var t=Math.max(n.latMax-n.latMin,n.longMax-n.longMin)/512;return{x:Math.round((n.longMax-n.longMin)/t),y:Math.round((n.latMax-n.latMin)/t),increment:t}}(n);for(var i=0;i<o.dimensions.x;i++){for(var a=[],r=function(){var n=new h,r=y(o,{x:i,y:s});if(n.withinBounds=(0,c.Z)(r,t),n.withinBounds){var d=(0,u.Z)("EPSG:4326","EPSG:3857",r);n.isLand=e.every((function(n){return!("Polygon"===n.type&&n.bbox&&v(d,n.bbox)&&(0,c.Z)(d,n))}))}n.withinBounds&&n.isLand||(o.countExcludedElements++,n.excluded=!0),a.push(n)},s=0;s<o.dimensions.y;s++)r();o.data.push(a)}return o}function E(n,t){return t.forEach((function(t){for(var e=0;e<t.coordinates.length-1;e++)for(var o=(0,u.Z)("EPSG:3857","EPSG:4326",t.coordinates[e]),i=(0,u.Z)("EPSG:3857","EPSG:4326",t.coordinates[e+1]),a=[i[0]-o[0],i[1]-o[1]],r=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)),s=0;s<r;s+=n.dimensions.increment){var c={long:o[0]+s*a[0]/r,lat:o[1]+s*a[1]/r},d=b(n,c);null!=d&&0===n.data[d.x][d.y].hasRoad&&(n.data[d.x][d.y].hasRoad=1,n.data[d.x][d.y].isLand&&n.data[d.x][d.y].withinBounds&&(n.countExcludedElements++,n.data[d.x][d.y].excluded=!0))}})),n}self.onmessage=function(){var n=(0,a.Z)((0,i.Z)().mark((function n(t){var e,o,a,r,s,u;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.data.waters.forEach((function(n){n.bbox=(0,d.Z)(n)})),e=g(t.data.bbox,t.data.selectedArea,t.data.waters),o=e.dimensions.x*e.dimensions.y,a=0,r=0,s=0,E(e,t.data.roads),u=(0,i.Z)().mark((function n(){var t;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a++,e=w(e,a),!(e.countExcludedElements/o>.05*r)){n.next=10;break}return t=Math.max(0,500+s-Date.now()),n.next=7,new Promise((function(n){return setTimeout(n,t)}));case 7:self.postMessage({isFinalResult:!1,img:new Blob([x(e)],{type:"image/png"}),coordinates:[]}),s=Date.now(),r++;case 10:console.debug("iteration #".concat(a,", roadElements: ").concat(e.countExcludedElements," / ").concat(o));case 11:case"end":return n.stop()}}),n)}));case 8:if(!(o>e.countExcludedElements&&a<512)){n.next=12;break}return n.delegateYield(u(),"t0",10);case 10:n.next=8;break;case 12:if(e.furthestAway){n.next=17;break}return console.error("Did not find last colorized point within iteration limit. Error!"),n.abrupt("return",null);case 17:console.debug("Found point @".concat(e.furthestAway.x,",").concat(e.furthestAway.y)),self.postMessage({isFinalResult:!0,img:new Blob([x(e)],{type:"image/png"}),coordinates:y(e,e.furthestAway)});case 19:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}()}},t={};function e(o){var i=t[o];if(void 0!==i)return i.exports;var a=t[o]={exports:{}};return n[o](a,a.exports,e),a.exports}e.m=n,e.x=function(){var n=e.O(void 0,[18],(function(){return e(1504)}));return n=e.O(n)},function(){var n=[];e.O=function(t,o,i,a){if(!o){var r=1/0;for(d=0;d<n.length;d++){o=n[d][0],i=n[d][1],a=n[d][2];for(var s=!0,u=0;u<o.length;u++)(!1&a||r>=a)&&Object.keys(e.O).every((function(n){return e.O[n](o[u])}))?o.splice(u--,1):(s=!1,a<r&&(r=a));if(s){n.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}a=a||0;for(var d=n.length;d>0&&n[d-1][2]>a;d--)n[d]=n[d-1];n[d]=[o,i,a]}}(),e.d=function(n,t){for(var o in t)e.o(t,o)&&!e.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:t[o]})},e.f={},e.e=function(n){return Promise.all(Object.keys(e.f).reduce((function(t,o){return e.f[o](n,t),t}),[]))},e.u=function(n){return"static/js/"+n+".ddacdc00.chunk.js"},e.miniCssF=function(n){},e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"===typeof window)return window}}(),e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="/",function(){var n={504:1};e.f.i=function(t,o){n[t]||importScripts(e.p+e.u(t))};var t=self.webpackChunkfarfromroad=self.webpackChunkfarfromroad||[],o=t.push.bind(t);t.push=function(t){var i=t[0],a=t[1],r=t[2];for(var s in a)e.o(a,s)&&(e.m[s]=a[s]);for(r&&r(e);i.length;)n[i.pop()]=1;o(t)}}(),function(){var n=e.x;e.x=function(){return e.e(18).then(n)}}();e.x()}();
//# sourceMappingURL=504.387553fc.chunk.js.map