{"version":3,"file":"static/js/504.387553fc.chunk.js","mappings":"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","sources":["drawGrid.ts","searchFarthestPoint.worker.ts","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/global","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["import { PNG } from 'pngjs/browser';\nimport { Grid } from './searchFarthestPoint.worker';\n\nenum Color {\n    BLACK,\n    BLUE,\n    RED,\n}\n\nfunction getColors(color: Color): [number, number, number] {\n    switch (color) {\n        case Color.BLACK:\n            return [0,0,0];\n        case Color.BLUE:\n            return [0,0,255];\n        case Color.RED:\n            return [255,0,0];\n        default:\n            return [0,0,0];\n    }\n}\n\nfunction paintPoint(data: Buffer, x: number, i: number, j: number, color: Color ) {\n    const colorRgb = getColors(color);\n    const idx = (j * x + i) << 2\n    data[idx] = colorRgb[0]\n    data[idx + 1] = colorRgb[1]\n    data[idx + 2] = colorRgb[2]\n    data[idx + 3] = 196\n}\n\nfunction gridToPng(grid: Grid) {\n    const png = new PNG({\n        colorType: 0,\n        width: grid.dimensions.x,\n        height: grid.dimensions.y,\n        filterType: -1\n    });\n\n    for (let i = 0; i < grid.dimensions.x; i++) {\n        for (let j = 0; j < grid.dimensions.y; j++) {\n            if (grid.data[i][j].hasRoad > 0) {\n                paintPoint(png.data, grid.dimensions.x, i, j, Color.BLACK)\n            } else if (!grid.data[i][j].isLand) {\n                paintPoint(png.data, grid.dimensions.x, i, j, Color.BLUE)\n            } else if (!grid.data[i][j].withinBounds) {\n                paintPoint(png.data, grid.dimensions.x, i, j, Color.RED)\n            }\n        }\n    }\n\n    return PNG.sync.write(png)\n}\n\nexport { gridToPng };","/* eslint-disable no-restricted-globals */\nimport { BBox, Geometry, Polygon } from 'geojson';\nimport proj4 from 'proj4';\nimport booleanPointInPolygon from '@turf/boolean-point-in-polygon';\nimport bbox from '@turf/bbox';\n\nimport { BoundingBox, MainToWorkerMessage } from './WorkerMessages';\nimport { gridToPng } from './drawGrid';\n\nconst GRID_MAX_RESOLUTION = 512.0\nconst DENSITY_STEP = 0.05 // Output one image every % of density\n\n\nclass GridElement {\n  hasRoad: number = 0;\n  isLand: boolean = true;\n  withinBounds: boolean = false;\n  excluded: boolean = false;\n}\n\nclass Grid {\n  dimensions: {\n    x: number;\n    y: number;\n    increment: number;\n  } = { x: 0, y: 0, increment: 0 };\n  data: GridElement[][] = [];\n  furthestAway: null | { x: number; y: number; } = null;\n  bbox: BoundingBox = { latMin: 0, latMax: 0, longMin: 0, longMax: 0 }\n  countExcludedElements: number = 0;\n};\n\n\nfunction dimensions(bbox: BoundingBox) {\n  var largestDimension = Math.max(\n    bbox.latMax - bbox.latMin,\n    bbox.longMax - bbox.longMin\n  )\n  var increment = largestDimension / GRID_MAX_RESOLUTION\n  return {\n    //TODO: Check that x and y are always positive. What if bbox cross -180/+180°?\n    x: Math.round((bbox.longMax - bbox.longMin) / increment),\n    y: Math.round((bbox.latMax - bbox.latMin) / increment),\n    increment: increment,\n  }\n}\n\nfunction utmToGrid(grid: Grid, point: { long: any; lat: any; }) {\n  if (\n    point.lat < grid.bbox.latMin ||\n    point.lat > grid.bbox.latMax ||\n    point.long < grid.bbox.longMin ||\n    point.long > grid.bbox.longMax\n  ) {\n    //console.error(`Point (${point.long},${point.lat}) is out of bbox bounds, cannot be found in grid`)\n    return null\n  } else {\n    var x = Math.min(Math.floor((point.long - grid.bbox.longMin) / grid.dimensions.increment), grid.dimensions.x - 1)\n    // y-axis is top to bottom in figure but top to ceiling in utm; invert coordinate\n    var y = Math.min(grid.dimensions.y - Math.floor((point.lat - grid.bbox.latMin) / grid.dimensions.increment), grid.dimensions.y - 1)\n    //console.debug(`Point (${point.lat},${point.long}) => (${x}, ${y})`)\n    return {\n      x: x,\n      y: y\n    }\n  }\n}\n\nfunction gridToUtm(grid: Grid, point: { x: number; y: number; }) {\n  // Aim for the middle of pixel\n  return [\n    grid.bbox.longMin + (point.x + 0.5) * grid.dimensions.increment,\n    grid.bbox.latMin + (0.5 + grid.dimensions.y - point.y) * grid.dimensions.increment,\n  ];\n}\n\nfunction setRoad(grid: Grid, i: number, j: number, iteration: number) {\n  if (i < 0 || i >= grid.dimensions.x || j < 0 || j >= grid.dimensions.y) {\n    return\n  } else {\n    if (grid.data[i][j].hasRoad === 0) {\n      grid.data[i][j].hasRoad = iteration + 1\n      if (grid.data[i][j].isLand && grid.data[i][j].withinBounds) {\n        grid.countExcludedElements++;\n        // Last point colorized?\n        if (!grid.furthestAway && grid.countExcludedElements === grid.dimensions.x * grid.dimensions.y) {\n          grid.furthestAway = {\n            x: i,\n            y: j\n          }\n        }\n      }\n    }\n  }\n}\n\nfunction growRoads(grid: Grid, iteration: number) {\n  for (var i = 0; i < grid.dimensions.x; i++) {\n    for (var j = 0; j < grid.dimensions.y; j++) {\n      if (grid.data[i][j].hasRoad === iteration) {\n        setRoad(grid, i - 1, j, iteration)\n        setRoad(grid, i + 1, j, iteration)\n        setRoad(grid, i, j - 1, iteration)\n        setRoad(grid, i, j + 1, iteration)\n      }\n    }\n  }\n  return grid\n}\n\nfunction pointInBbox(point: number[], bbox: BBox){\n  return point[0] > bbox[0] && point[0] < bbox[2] && point[1] > bbox[1] && point[1] < bbox[3];\n}\n\nfunction generateGrid(bbox: BoundingBox, selectedArea: Polygon, waters: Geometry[]): Grid {\n  let res = new Grid();\n  res.bbox = bbox\n  res.dimensions = dimensions(bbox)\n  for (var i = 0; i < res.dimensions.x; i++) {\n    var long = []\n    for (var j = 0; j < res.dimensions.y; j++) {\n      const e = new GridElement();\n      const point = gridToUtm(res, { x: i, y: j });\n      e.withinBounds = booleanPointInPolygon(point, selectedArea);\n      if (e.withinBounds) {\n        const point3857 = proj4('EPSG:4326', 'EPSG:3857', point)\n        e.isLand = waters.every(w => {\n          if (w.type === 'Polygon' && w.bbox && pointInBbox(point3857, w.bbox) && booleanPointInPolygon(point3857, w)) {\n            return false;\n          }\n          return true;\n        });\n      }\n      if (!e.withinBounds || !e.isLand) {\n        res.countExcludedElements++;\n        e.excluded = true;\n      }\n      long.push(e);\n    }\n    res.data.push(long)\n  }\n  return res\n}\n\nfunction fillRoads(grid: Grid, roads: any[]) {\n  roads.forEach((r: { coordinates: number[][] }) => {\n    for (let i = 0; i < r.coordinates.length - 1; i++) {\n      const currPoint = proj4('EPSG:3857', 'EPSG:4326', r.coordinates[i]);\n      const nextPoint = proj4('EPSG:3857', 'EPSG:4326', r.coordinates[i + 1])\n      const vector = [nextPoint[0] - currPoint[0], nextPoint[1] - currPoint[1]]\n      const vectorLength = Math.sqrt(Math.pow(vector[0], 2) + Math.pow(vector[1], 2))\n\n      // Paint 1 pixel in between each line point: Go along computed vector and paint every #\n      for (let j = 0.0; j < vectorLength; j += grid.dimensions.increment) {\n        const element = {\n          long: currPoint[0] + j * vector[0] / vectorLength,\n          lat: currPoint[1] + j * vector[1] / vectorLength\n        }\n        const position = utmToGrid(grid, element)\n        if (position != null && grid.data[position.x][position.y].hasRoad === 0) { // Point from road might not be within boundaries, as road does not stop at bbox\n          grid.data[position.x][position.y].hasRoad = 1;\n          if (grid.data[position.x][position.y].isLand && grid.data[position.x][position.y].withinBounds) {\n            grid.countExcludedElements++\n            grid.data[position.x][position.y].excluded = true;\n          }\n        }\n      }\n    }\n  })\n  return grid\n}\n\nself.onmessage = async (e: MessageEvent<MainToWorkerMessage>) => {\n  e.data.waters.forEach(w => {\n    w.bbox = bbox(w);\n  });\n  let grid = generateGrid(e.data.bbox, e.data.selectedArea, e.data.waters);\n  const gridPointsTotal = grid.dimensions.x * grid.dimensions.y\n  let iteration = 0;\n  let sentImages = 0;\n  let lastImageSent = 0;\n  fillRoads(grid, e.data.roads);\n\n  while (gridPointsTotal > grid.countExcludedElements && iteration < GRID_MAX_RESOLUTION) {\n    iteration++;\n    grid = growRoads(grid, iteration)\n    var density = grid.countExcludedElements / gridPointsTotal;\n    if (density > sentImages * DENSITY_STEP) {\n      // Send one image every 500ms minimum, so that the animation is visible\n      const waitTime = Math.max(0, 500 + lastImageSent - Date.now());\n      await new Promise(r => setTimeout(r, waitTime));\n      self.postMessage({\n        isFinalResult: false,\n        img: new Blob([gridToPng(grid)], { type: 'image/png' }),\n        coordinates: [],\n      });\n      lastImageSent = Date.now();\n      sentImages++;\n    }\n    console.debug(`iteration #${iteration}, roadElements: ${grid.countExcludedElements} / ${gridPointsTotal}`)\n  }\n  if (!grid.furthestAway) {\n    console.error(\"Did not find last colorized point within iteration limit. Error!\")\n    return null\n  } else {\n    console.debug(`Found point @${grid.furthestAway.x},${grid.furthestAway.y}`)\n    self.postMessage({\n      isFinalResult: true,\n      img: new Blob([gridToPng(grid)], { type: 'image/png' }),\n      coordinates: gridToUtm(grid, grid.furthestAway),\n    });\n  }\n};\n\nexport { Grid };","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = function() {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [18], function() { return __webpack_require__(1504); })\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"ddacdc00\" + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t504: 1\n};\n\n// importScripts chunk loading\nvar installChunk = function(data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = function(chunkId, promises) {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkfarfromroad\"] = self[\"webpackChunkfarfromroad\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = function() {\n\treturn __webpack_require__.e(18).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["Color","paintPoint","data","x","i","j","color","colorRgb","BLACK","BLUE","RED","getColors","idx","gridToPng","grid","png","PNG","colorType","width","dimensions","height","y","filterType","hasRoad","isLand","withinBounds","GridElement","excluded","Grid","increment","furthestAway","bbox","latMin","latMax","longMin","longMax","countExcludedElements","utmToGrid","point","lat","long","Math","min","floor","gridToUtm","setRoad","iteration","growRoads","pointInBbox","generateGrid","selectedArea","waters","res","max","round","e","booleanPointInPolygon","point3857","proj4","every","w","type","push","fillRoads","roads","forEach","r","coordinates","length","currPoint","nextPoint","vector","vectorLength","sqrt","pow","element","position","self","onmessage","gridPointsTotal","sentImages","lastImageSent","waitTime","Date","now","Promise","setTimeout","postMessage","isFinalResult","img","Blob","console","debug","error","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","__webpack_exports__","O","deferred","result","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","Object","keys","key","splice","d","definition","o","defineProperty","enumerable","get","f","chunkId","all","reduce","promises","u","miniCssF","g","globalThis","this","Function","window","obj","prop","prototype","hasOwnProperty","call","p","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop","next","then"],"sourceRoot":""}